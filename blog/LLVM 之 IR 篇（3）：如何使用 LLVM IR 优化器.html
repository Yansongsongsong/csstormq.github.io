<!DOCTYPE html>
<html>
<head>  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,height=device-height,initial-scale=1,user-scalable=0">
  <meta name="author" content="微信公众号：颜家大少">
  <meta name="email" content="3056432@qq.com">
  <meta name="description" content="一个Markdown在线转换工具，让Markdown内容，不需作任何调整就能同时在微信公众号、博客园、掘金、csdn等平台正确显示当前预览的效果">
  <title>StormQ's Blog</title>  
  <style type="text/css" id="markdown_preview_css"> 
 .output_wrapper pre code{font-family: Consolas, Inconsolata, Courier, monospace; display: block !important; white-space: pre !important; word-wrap: normal !important; word-break: normal !important;  overflow: auto !important;}  
 
.output_wrapper .hljs{color: rgb(169, 183, 198); background: rgb(40, 43, 46) none repeat scroll 0% 0%; display: block; overflow-x: auto; padding: 0.5em;}

.output_wrapper .hljs-params{color: rgb(255, 152, 35);}

.output_wrapper .hljs-number,.output_wrapper  .hljs-literal,.output_wrapper  .hljs-symbol,.output_wrapper  .hljs-bullet{color: rgb(174, 135, 250);}

.output_wrapper .hljs-function,.output_wrapper  .hljs-built_in,.output_wrapper  .hljs-name,.output_wrapper  .hljs-keyword,.output_wrapper  .hljs-selector-tag,.output_wrapper  .hljs-deletion{color: rgb(248, 35, 117);}

.output_wrapper .hljs-variable,.output_wrapper  .hljs-template-variable,.output_wrapper  .hljs-link{color: rgb(98, 151, 85);}

.output_wrapper .hljs-comment,.output_wrapper  .hljs-quote{color: rgb(128, 128, 128);}

.output_wrapper .hljs-meta{color: rgb(91, 218, 237);}

.output_wrapper .hljs-string,.output_wrapper  .hljs-attribute,.output_wrapper  .hljs-addition{color: rgb(238, 220, 112);}

.output_wrapper .hljs-attr,.output_wrapper  .hljs-section,.output_wrapper  .hljs-title,.output_wrapper  .hljs-type{color: rgb(165, 218, 45);}

.output_wrapper .hljs-selector-class{color: rgb(165, 218, 45);}

.output_wrapper .hljs-emphasis{font-style: italic;}

.output_wrapper .hljs-strong{font-weight: bold;}
 
.output_wrapper pre code {line-height: 18px; font-size: 14px; font-weight: normal; word-spacing: 0px; letter-spacing: 0px;} 
.output_wrapper{font-size: 16px; color: rgb(62, 62, 62); line-height: 1.6; word-spacing: 0px; letter-spacing: 0px; font-family: "Helvetica Neue", Helvetica, "Hiragino Sans GB", "Microsoft YaHei", Arial, sans-serif;}

.output_wrapper *{font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;}

.output_wrapper p{margin: 1.5em 0px;}

.output_wrapper h1,.output_wrapper  h2,.output_wrapper  h3,.output_wrapper  h4,.output_wrapper  h5,.output_wrapper  h6{margin: 1.5em 0px; font-weight: bold;}

.output_wrapper h1{font-size: 1.6em;}

.output_wrapper h2{font-size: 1.4em;}

.output_wrapper h3{font-size: 1.3em;}

.output_wrapper h4{font-size: 1.2em;}

.output_wrapper h5{font-size: 1em;}

.output_wrapper h6{font-size: 1em;}

.output_wrapper h3{margin-bottom: 2em; margin-right: 5px; padding: 8px 15px; letter-spacing: 2px; background-image: linear-gradient(to right bottom, rgb(0, 188, 212), rgb(63, 81, 181)); background-color: rgb(63, 81, 181); color: rgb(255, 255, 255); border-left: 10px solid rgb(51, 51, 51); border-radius: 5px; text-shadow: rgb(102, 102, 102) 1px 1px 1px; box-shadow: rgb(102, 102, 102) 1px 1px 2px;}

.output_wrapper ul,.output_wrapper  ol{padding-left: 32px;}

.output_wrapper ul{list-style-type: disc;}

.output_wrapper ol{list-style-type: decimal;}

.output_wrapper li *{}

.output_wrapper li{margin-bottom: 0.5em;}

.output_wrapper .code_size_default{line-height: 18px; font-size: 14px; font-weight: normal; word-spacing: 0px; letter-spacing: 0px;}

.output_wrapper .code_size_tight{line-height: 15px; font-size: 11px; font-weight: normal; word-spacing: -3px; letter-spacing: 0px;}

.output_wrapper pre code{font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px;}

.output_wrapper blockquote{display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(129, 145, 152); border-left: 6px solid rgb(220, 230, 240); background: rgb(242, 247, 251) none repeat scroll 0% 0%; overflow: auto; overflow-wrap: normal; word-break: normal;}

.output_wrapper blockquote p{margin: 0px;}

.output_wrapper a{text-decoration: none; color: rgb(30, 107, 184); overflow-wrap: break-word;}

.output_wrapper strong{font-weight: bold;}

.output_wrapper em{font-style: italic;}

.output_wrapper del{font-style: italic;}

.output_wrapper strong em{font-weight: bold;}

.output_wrapper hr{height: 1px; margin: 1.5rem 0px; border-color: rgb(165, 165, 165) currentcolor currentcolor; border-style: dashed none none; border-width: 1px medium medium; border-image: none 100% / 1 / 0 stretch;}

.output_wrapper code{overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(233, 105, 0); background: rgb(248, 248, 248) none repeat scroll 0% 0%;}

.output_wrapper img{display: block; margin: 0px auto; max-width: 100%;}

.output_wrapper figcaption{margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;}

.output_wrapper table{display: table; width: 100%; text-align: left;}

.output_wrapper tbody{border: 0px none;}

.output_wrapper table tr{border-color: rgb(204, 204, 204) currentcolor currentcolor; border-style: solid none none; border-width: 1px 0px 0px; border-image: none 100% / 1 / 0 stretch; background-color: white;}

.output_wrapper table tr th,.output_wrapper  table tr td{font-size: 1em; border: 1px solid rgb(204, 204, 204); padding: 0.5em 1em; text-align: left;}

.output_wrapper table tr th{font-weight: bold; background-color: rgb(240, 240, 240);}

.output_wrapper .katex-display{font-size: 1.22em;}

.output_wrapper .katex{padding: 8px 3px;}

.output_wrapper .katex-display > .katex{display: inline-block; text-align: center; padding: 3px;}

.output_wrapper .katex img{display: inline-block; vertical-align: middle;}

.output_wrapper a[href^="#"] sup{vertical-align: super; margin: 0px 2px; padding: 1px 3px; color: rgb(255, 255, 255); background: rgb(102, 102, 102) none repeat scroll 0% 0%; font-size: 0.7em;}

.output_wrapper .task-list-list{list-style-type: none;}

.output_wrapper .task-list-list.checked{color: rgb(62, 62, 62);}

.output_wrapper .task-list-list.uncheck{color: rgb(191, 193, 191);}

.output_wrapper .task-list-list .icon_uncheck,.output_wrapper  .task-list-list .icon_check{display: inline-block; vertical-align: middle; margin-right: 10px;}

.output_wrapper .task-list-list .icon_check::before{content: "√"; border: 2px solid rgb(62, 62, 62); color: red;}

.output_wrapper .task-list-list .icon_uncheck::before{content: "x"; border: 2px solid rgb(191, 193, 191); color: rgb(191, 193, 191);}

.output_wrapper .task-list-list .icon_check::before,.output_wrapper  .task-list-list .icon_uncheck::before{padding: 2px 8px 2px 5px; border-radius: 5px;}

.output_wrapper .toc{margin-left: 25px;}

.output_wrapper .toc_item{display: block;}

.output_wrapper .toc_left{margin-left: 25px;}
 
</style>  
  <style type="text/css" id="export_setting_css">body { width: 100%; margin: 0px; padding: 0px; background: rgb(255, 255, 255) none repeat scroll 0% 0%; }
#export_content { margin: 40px 20%; padding: 20px; background: rgb(255, 255, 255) none repeat scroll 0% 0%; }</style>  

</head><body><div id="export_content"><div class="output_wrapper" id="output_wrapper_id"><h1 id="hpaligncenterfontsize6llvmir3llvmirfontp"><span><p align="center"><strong><font size="6">LLVM 之 IR 篇（3）：如何使用 LLVM IR 优化器</font></strong></p></span></h1>
<p align="right">Author: stormQ</p>
<p align="right">Created: Wednesday, 28. July 2021 12:19PM</p>
<p align="right">Last Modified: Tuesday, 03. August 2021 10:31PM</p>
<hr>
<ul>
<li><h3 id="h"><span>目录</span></h3>
<ul>
<p class="task-list-list checked" style="list-style-type: none;"><i class="icon_check"></i><a href="#jump摘要">摘要</a></p>
<p class="task-list-list checked" style="list-style-type: none;"><i class="icon_check"></i><a href="#jump1">LLVM IR 优化概述</a></p>
<p class="task-list-list checked" style="list-style-type: none;"><i class="icon_check"></i><a href="#jump2">如何启用优化</a></p>
<p class="task-list-list checked" style="list-style-type: none;"><i class="icon_check"></i><a href="#jump3">查看优化的统计信息</a></p>
<p class="task-list-list checked" style="list-style-type: none;"><i class="icon_check"></i><a href="#jump4">查看实际启用的优化及依赖关系</a></p>
<p class="task-list-list checked" style="list-style-type: none;"><i class="icon_check"></i><a href="#jump5">查看优化的执行时间</a></p>
<p class="task-list-list checked" style="list-style-type: none;"><i class="icon_check"></i><a href="#jumpReferences">References</a></p></ul><p></p>
</li></ul>
<hr>
<h3 id="hspanidjumpspan"><span><span id="jump摘要">摘要</span></span></h3>
<p>本文基于<code>release/12.x</code>版本的 LLVM 源码，介绍了 LLVM IR 优化的基本概念以及<code>opt</code>工具的使用方法。从而，初步了解 LLVM IR 优化器以便更深入地研究相关内容。</p>
<hr>
<h3 id="hspanidjump1llvmirspan"><span><span id="jump1">LLVM IR 优化概述</span></span></h3>
<p>根据优化发生的时期，LLVM IR 层面的优化可以分为如下两种：</p>
<ul>
<li><p>编译期优化。</p></li>
<li><p>链接期优化（跨编译单元）。</p></li>
</ul>
<p>根据不同的优化范围，LLVM IR 层面的优化可以分为如下三种：</p>
<ul>
<li><p>过程内优化。每次仅对一个函数进行优化。</p></li>
<li><p>过程间优化。每次对一个编译单元进行优化。</p></li>
<li><p>链接期优化。通过<code>llvm-link</code>工具将多个编译单元合并成一个，从而每次可以对多个编译单元进行优化。</p></li>
</ul>
<p>我们可以通过<code>opt</code>工具启用这些优化。它既可以根据不同的优化等级选项启用不同的优化流水线（即一系列按照特定顺序执行的优化），也可以单独启用指定的优化。</p>
<hr>
<h3 id="hspanidjump2span"><span><span id="jump2">如何启用优化</span></span></h3>
<ul>
<p class="task-list-list checked" style="list-style-type: none;"><i class="icon_check"></i><a href="#jump2_1">启用不同优化等级的优化</a></p>
<p class="task-list-list checked" style="list-style-type: none;"><i class="icon_check"></i><a href="#jump2_2">启用基于传统 Pass 框架的优化</a></p>
<p class="task-list-list checked" style="list-style-type: none;"><i class="icon_check"></i><a href="#jump2_3">启用基于新 Pass 框架的优化</a></p>
</ul>
<hr>
<h4 id="hspanidjump2_1span"><span><span id="jump2_1">启用不同优化等级的优化</span></span></h4>
<p>命令格式（输出 LLVM IR 位码文件）：</p>
<pre><code class="hljs delphi">$&nbsp;opt&nbsp;-O&lt;level&gt;&nbsp;&lt;bitcode-<span class="hljs-keyword">file</span>&nbsp;<span class="hljs-keyword">or</span>&nbsp;assembly-<span class="hljs-keyword">file</span>&gt;&nbsp;-o&nbsp;&lt;bitcode-<span class="hljs-keyword">file</span>&gt;<br></code></pre>
<p><em>注：</em><code>opt</code>工具的输入既可以是 LLVM IR 位码文件，也可以是 LLVM IR 汇编文件。</p>
<p>命令格式（输出 LLVM IR 汇编文件）：</p>
<pre><code class="hljs delphi">$&nbsp;opt&nbsp;-O&lt;level&gt;&nbsp;&lt;bitcode-<span class="hljs-keyword">file</span>&nbsp;<span class="hljs-keyword">or</span>&nbsp;assembly-<span class="hljs-keyword">file</span>&gt;&nbsp;-S&nbsp;-o&nbsp;&lt;assembly-<span class="hljs-keyword">file</span>&gt;<br></code></pre>
<p><strong>需要注意的是，</strong> 无论启用的优化等级是什么，都不会对带<code>optnone</code>属性的函数生效。</p>
<p>在 LLVM 12.0.0 版本中，<code>opt</code>工具支持的优化等级选项有：<code>-O0</code>、<code>-O1</code>、<code>-O2</code>、<code>-O3</code>、<code>-Os</code>、<code>-Oz</code>，如下表所示。</p>
<table>
<thead>
<tr>
<th>opt 支持的优化等级选项（在 LLVM 12.0.0 版本中）</th>
<th>行为</th>
</tr>
</thead>
<tbody>
<tr>
<td>-O0</td>
<td>不优化</td>
</tr>
<tr>
<td>-O1</td>
<td>介于 -O0 和 -O2 之间的优化</td>
</tr>
<tr>
<td>-O2</td>
<td>启用大多数优化</td>
</tr>
<tr>
<td>-O3</td>
<td>与 -O2 类似，并启用试图使程序运行得更快的优化（代码大小可能会增加）</td>
</tr>
<tr>
<td>-Os</td>
<td>与 -O2 类似，并启用减少代码大小的优化</td>
</tr>
<tr>
<td>-Oz</td>
<td>与 -O2、-Os 类似，并启用进一步减少代码大小的优化</td>
</tr>
</tbody>
</table>
<p>示例：</p>
<pre><code class="hljs php">$&nbsp;opt&nbsp;-O1&nbsp;test_without_optnone.ll&nbsp;-o&nbsp;test_without_optnone_O1_opt.bc<br></code></pre>
<p><em>注：</em> 通过手工删除后，test_without_optnone.ll 汇编文件中的函数都不带<code>optnone</code>属性。从而，可以验证<code>-O1</code>选项的优化效果。</p>
<p><a href="#jump2">返回上一级</a></p>
<hr>
<h4 id="hspanidjump2_2passspan"><span><span id="jump2_2">启用基于传统 Pass 框架的优化</span></span></h4>
<p><strong>1）</strong> 启用 opt 工具自带的基于传统 Pass 框架的优化</p>
<p>命令格式：</p>
<pre><code class="hljs delphi">$&nbsp;opt&nbsp;-&lt;pass1-<span class="hljs-keyword">name</span>&gt;&nbsp;-&lt;pass2-<span class="hljs-keyword">name</span>&gt;&nbsp;&lt;bitcode-<span class="hljs-keyword">file</span>&nbsp;<span class="hljs-keyword">or</span>&nbsp;assembly-<span class="hljs-keyword">file</span>&gt;&nbsp;-o&nbsp;&lt;bitcode-<span class="hljs-keyword">file</span>&gt;<br></code></pre>
<p><strong>需要注意的是，</strong> <code>opt</code>工具自带的基于传统 Pass 框架的优化，都不会对带<code>optnone</code>属性的函数生效。</p>
<p>示例：</p>
<pre><code class="hljs php">$&nbsp;opt&nbsp;-mem2reg&nbsp;test_without_optnone.ll&nbsp;-o&nbsp;test_without_optnone_mem2reg_opt.bc<br></code></pre>
<p><strong>2）</strong> 启用自定义的基于传统 Pass 框架的优化</p>
<p>命令格式（输出优化后的位码文件）：</p>
<pre><code class="hljs sql">$&nbsp;opt&nbsp;-<span class="hljs-keyword">load</span>&nbsp;&lt;pass-<span class="hljs-keyword">shared</span>-<span class="hljs-keyword">library</span>&gt;&nbsp;-&lt;pass1-<span class="hljs-keyword">name</span>&gt;&nbsp;-&lt;pass2-<span class="hljs-keyword">name</span>&gt;&nbsp;&lt;bitcode-<span class="hljs-keyword">file</span>&nbsp;<span class="hljs-keyword">or</span>&nbsp;<span class="hljs-keyword">assembly</span>-<span class="hljs-keyword">file</span>&gt;&nbsp;-o&nbsp;&lt;bitcode-<span class="hljs-keyword">file</span>&gt;<br></code></pre>
<p>命令格式（不输出优化后的位码文件）：</p>
<pre><code class="hljs sql">$&nbsp;opt&nbsp;-<span class="hljs-keyword">load</span>&nbsp;&lt;pass-<span class="hljs-keyword">shared</span>-<span class="hljs-keyword">library</span>&gt;&nbsp;-&lt;pass1-<span class="hljs-keyword">name</span>&gt;&nbsp;-&lt;pass2-<span class="hljs-keyword">name</span>&gt;&nbsp;&lt;bitcode-<span class="hljs-keyword">file</span>&nbsp;<span class="hljs-keyword">or</span>&nbsp;<span class="hljs-keyword">assembly</span>-<span class="hljs-keyword">file</span>&gt;&nbsp;&gt;&nbsp;/dev/<span class="hljs-literal">null</span><br></code></pre>
<p>或</p>
<pre><code class="hljs sql">$&nbsp;opt&nbsp;-disable-output&nbsp;-<span class="hljs-keyword">load</span>&nbsp;&lt;pass-<span class="hljs-keyword">shared</span>-<span class="hljs-keyword">library</span>&gt;&nbsp;-&lt;pass1-<span class="hljs-keyword">name</span>&gt;&nbsp;-&lt;pass2-<span class="hljs-keyword">name</span>&gt;&nbsp;&lt;bitcode-<span class="hljs-keyword">file</span>&nbsp;<span class="hljs-keyword">or</span>&nbsp;<span class="hljs-keyword">assembly</span>-<span class="hljs-keyword">file</span>&gt;<br></code></pre>
<p><em>注：</em>对于不输出优化后的位码文件的情况，上述命令中添加<code>&gt; /dev/null</code>重定向或者<code>-disable-output</code>选项都是为了避免以下内容的输出：</p>
<pre><code class="text language-text">WARNING:&nbsp;You're&nbsp;attempting&nbsp;to&nbsp;print&nbsp;out&nbsp;a&nbsp;bitcode&nbsp;file.<br>This&nbsp;is&nbsp;inadvisable&nbsp;as&nbsp;it&nbsp;may&nbsp;cause&nbsp;display&nbsp;problems.&nbsp;If<br>you&nbsp;REALLY&nbsp;want&nbsp;to&nbsp;taste&nbsp;LLVM&nbsp;bitcode&nbsp;first-hand,&nbsp;you<br>can&nbsp;force&nbsp;output&nbsp;with&nbsp;the&nbsp;`-f'&nbsp;option.<br></code></pre>
<p><strong>需要注意的是，</strong> 自定义的基于传统 Pass 框架的优化，对带<code>optnone</code>属性的函数是生效的。</p>
<p>示例：</p>
<pre><code class="hljs ruby">$&nbsp;opt&nbsp;-disable-output&nbsp;-load&nbsp;~<span class="hljs-regexp">/git-projects/llvm</span>-project/build_ninja/lib/LLVMFnArgCntPlugin.so&nbsp;-plugin.fnargcnt&nbsp;test_with_optnone.ll<br></code></pre>
<p><em>注：</em>自定义的基于传统 Pass 框架的优化<code>plugin.fnargcnt</code>用于统计函数的参数个数。</p>
<p>输出结果如下：</p>
<pre><code class="hljs nginx"><span class="hljs-attribute">FnArgCntPass</span>&nbsp;---&nbsp;foo:&nbsp;<span class="hljs-number">1</span><br></code></pre>
<p><a href="#jump2">返回上一级</a></p>
<hr>
<h4 id="hspanidjump2_3passspan"><span><span id="jump2_3">启用基于新 Pass 框架的优化</span></span></h4>
<p>命令格式（不输出优化后的位码文件）：</p>
<pre><code class="hljs delphi">$&nbsp;opt&nbsp;-disable-output&nbsp;-passes=&lt;pass1-<span class="hljs-keyword">name</span>,pass2-<span class="hljs-keyword">name</span>&gt;&nbsp;&lt;bitcode-<span class="hljs-keyword">file</span>&nbsp;<span class="hljs-keyword">or</span>&nbsp;assembly-<span class="hljs-keyword">file</span>&gt;<br></code></pre>
<p><strong>需要注意的是，</strong> 基于新 Pass 框架的优化，无论是<code>opt</code>工具自带的还是自定义的，都不会对带<code>optnone</code>属性的函数生效。</p>
<p>示例：</p>
<pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash">&nbsp;opt&nbsp;-<span class="hljs-built_in">disable</span>-output&nbsp;-passes=fnargcnt&nbsp;test_without_optnone.ll</span><br></code></pre>
<p><em>注：</em>自定义的基于新 Pass 框架的优化<code>fnargcnt</code>用于统计函数的参数个数。</p>
<p>输出结果如下：</p>
<pre><code class="hljs nginx"><span class="hljs-attribute">FnArgCntPass</span>&nbsp;---&nbsp;foo:&nbsp;<span class="hljs-number">1</span><br></code></pre>
<p><a href="#jump2">返回上一级</a></p>
<hr>
<h3 id="hspanidjump3span"><span><span id="jump3">查看优化的统计信息</span></span></h3>
<p><strong>1）</strong> 使用 clang 驱动器时，查看优化的统计信息</p>
<p>命令格式（示例）：</p>
<pre><code class="hljs xml">$&nbsp;clang&nbsp;-Xclang&nbsp;-print-stats&nbsp;-emit-llvm&nbsp;-O<span class="hljs-tag">&lt;<span class="hljs-name">level</span>&gt;</span>&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">source-file</span>&gt;</span>&nbsp;-c&nbsp;-o&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">bitcode-file</span>&gt;</span><br></code></pre>
<p><em>注：</em>上述命令的输出结果中除了优化的统计信息之外，还有其他的统计信息。</p>
<p>示例：</p>
<pre><code class="hljs php">$&nbsp;clang&nbsp;-Xclang&nbsp;-<span class="hljs-keyword">print</span>-stats&nbsp;-emit-llvm&nbsp;-O1&nbsp;test.c&nbsp;-c&nbsp;-o&nbsp;test_O1_clang.bc<br></code></pre>
<p>输出结果如下（部分）：</p>
<pre><code class="hljs sql">省略&nbsp;...<br><br>===<span class="hljs-comment">-------------------------------------------------------------------------===</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;Statistics&nbsp;Collected&nbsp;...<br>===<span class="hljs-comment">-------------------------------------------------------------------------===</span><br><br>15&nbsp;assume-queries&nbsp;&nbsp;&nbsp;-&nbsp;Number&nbsp;of&nbsp;Queries&nbsp;into&nbsp;an&nbsp;assume&nbsp;assume&nbsp;bundles<br>&nbsp;1&nbsp;cgscc-passmgr&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;Maximum&nbsp;CGSCCPassMgr&nbsp;iterations&nbsp;on&nbsp;one&nbsp;SCC<br>&nbsp;6&nbsp;file-search&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;Number&nbsp;of&nbsp;directory&nbsp;<span class="hljs-keyword">cache</span>&nbsp;misses.<br>&nbsp;省略&nbsp;...<br>&nbsp;<span class="hljs-number">1</span>&nbsp;<span class="hljs-keyword">loop</span>-<span class="hljs-keyword">delete</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="hljs-built_in">Number</span>&nbsp;<span class="hljs-keyword">of</span>&nbsp;loops&nbsp;deleted<br>&nbsp;<span class="hljs-number">1</span>&nbsp;<span class="hljs-keyword">loop</span>-rotate&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="hljs-built_in">Number</span>&nbsp;<span class="hljs-keyword">of</span>&nbsp;loops&nbsp;rotated<br>&nbsp;<span class="hljs-number">1</span>&nbsp;<span class="hljs-keyword">loop</span>-unswitch&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;Total&nbsp;<span class="hljs-built_in">number</span>&nbsp;<span class="hljs-keyword">of</span>&nbsp;instructions&nbsp;analyzed<br>&nbsp;<span class="hljs-number">3</span>&nbsp;mem2reg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="hljs-built_in">Number</span>&nbsp;<span class="hljs-keyword">of</span>&nbsp;PHI&nbsp;nodes&nbsp;inserted<br>&nbsp;<span class="hljs-number">1</span>&nbsp;reassociate&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="hljs-built_in">Number</span>&nbsp;<span class="hljs-keyword">of</span>&nbsp;insts&nbsp;reassociated<br>&nbsp;<span class="hljs-number">2</span>&nbsp;scalar-evolution&nbsp;-&nbsp;<span class="hljs-built_in">Number</span>&nbsp;<span class="hljs-keyword">of</span>&nbsp;loops&nbsp;<span class="hljs-keyword">with</span>&nbsp;predictable&nbsp;<span class="hljs-keyword">loop</span>&nbsp;counts<br>&nbsp;<span class="hljs-number">7</span>&nbsp;simplifycfg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="hljs-built_in">Number</span>&nbsp;<span class="hljs-keyword">of</span>&nbsp;blocks&nbsp;simplified<br>&nbsp;<span class="hljs-number">1</span>&nbsp;sroa&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;Maximum&nbsp;<span class="hljs-built_in">number</span>&nbsp;<span class="hljs-keyword">of</span>&nbsp;<span class="hljs-keyword">partitions</span>&nbsp;per&nbsp;alloca<br>&nbsp;<span class="hljs-number">8</span>&nbsp;sroa&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;Maximum&nbsp;<span class="hljs-built_in">number</span>&nbsp;<span class="hljs-keyword">of</span>&nbsp;uses&nbsp;<span class="hljs-keyword">of</span>&nbsp;a&nbsp;<span class="hljs-keyword">partition</span><br><span class="hljs-number">14</span>&nbsp;sroa&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="hljs-built_in">Number</span>&nbsp;<span class="hljs-keyword">of</span>&nbsp;alloca&nbsp;<span class="hljs-keyword">partition</span>&nbsp;uses&nbsp;rewritten<br>&nbsp;<span class="hljs-number">2</span>&nbsp;sroa&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="hljs-built_in">Number</span>&nbsp;<span class="hljs-keyword">of</span>&nbsp;alloca&nbsp;<span class="hljs-keyword">partitions</span>&nbsp;formed<br>&nbsp;<span class="hljs-number">2</span>&nbsp;sroa&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="hljs-built_in">Number</span>&nbsp;<span class="hljs-keyword">of</span>&nbsp;allocas&nbsp;analyzed&nbsp;<span class="hljs-keyword">for</span>&nbsp;replacement<br><span class="hljs-number">16</span>&nbsp;sroa&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="hljs-built_in">Number</span>&nbsp;<span class="hljs-keyword">of</span>&nbsp;instructions&nbsp;deleted<br>&nbsp;<span class="hljs-number">2</span>&nbsp;sroa&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="hljs-built_in">Number</span>&nbsp;<span class="hljs-keyword">of</span>&nbsp;allocas&nbsp;promoted&nbsp;<span class="hljs-keyword">to</span>&nbsp;SSA&nbsp;<span class="hljs-keyword">values</span><br></code></pre>
<p><strong>2）</strong> 使用 opt 工具时，查看优化的统计信息</p>
<p>命令格式（示例）：</p>
<pre><code class="hljs delphi">$&nbsp;opt&nbsp;-stats&nbsp;-&lt;pass-<span class="hljs-keyword">name</span>&gt;&nbsp;&lt;bitcode-<span class="hljs-keyword">file</span>&nbsp;<span class="hljs-keyword">or</span>&nbsp;assembly-<span class="hljs-keyword">file</span>&gt;&nbsp;-o&nbsp;&lt;bitcode-<span class="hljs-keyword">file</span>&gt;<br></code></pre>
<p>示例：</p>
<pre><code class="hljs php">$&nbsp;opt&nbsp;-stats&nbsp;-mem2reg&nbsp;test_without_optnone.ll&nbsp;-o&nbsp;test_without_optnone_mem2reg_opt.bc<br></code></pre>
<p>输出结果如下：</p>
<pre><code class="hljs vbnet">===-------------------------------------------------------------------------===<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;Statistics&nbsp;Collected&nbsp;...<br>===-------------------------------------------------------------------------===<br><br><span class="hljs-number">3</span>&nbsp;mem2reg&nbsp;-&nbsp;Number&nbsp;<span class="hljs-keyword">of</span>&nbsp;PHI&nbsp;nodes&nbsp;inserted<br><span class="hljs-number">2</span>&nbsp;mem2reg&nbsp;-&nbsp;Number&nbsp;<span class="hljs-keyword">of</span>&nbsp;alloca<span class="hljs-comment">'s&nbsp;promoted</span><br></code></pre>
<hr>
<h3 id="hspanidjump4span"><span><span id="jump4">查看实际启用的优化及依赖关系</span></span></h3>
<p>命令格式（示例）：</p>
<pre><code class="hljs delphi">$&nbsp;opt&nbsp;-debug-pass=Structure&nbsp;-&lt;pass-<span class="hljs-keyword">name</span>&gt;&nbsp;&lt;bitcode-<span class="hljs-keyword">file</span>&nbsp;<span class="hljs-keyword">or</span>&nbsp;assembly-<span class="hljs-keyword">file</span>&gt;&nbsp;-o&nbsp;&lt;bitcode-<span class="hljs-keyword">file</span>&gt;<br></code></pre>
<p>示例：</p>
<pre><code class="hljs php">$&nbsp;opt&nbsp;-debug-pass=Structure&nbsp;-mem2reg&nbsp;test_without_optnone.ll&nbsp;-o&nbsp;test_without_optnone_O1_opt.bc<br></code></pre>
<p>输出结果如下：</p>
<pre><code class="hljs sql">Pass&nbsp;Arguments:&nbsp;&nbsp;-targetlibinfo&nbsp;-tti&nbsp;-targetpassconfig&nbsp;-assumption-<span class="hljs-keyword">cache</span>-tracker&nbsp;-domtree&nbsp;-mem2reg&nbsp;-<span class="hljs-keyword">verify</span>&nbsp;-write-bitcode<br>Target&nbsp;<span class="hljs-keyword">Library</span>&nbsp;Information<br>Target&nbsp;Transform&nbsp;Information<br>Target&nbsp;Pass&nbsp;Configuration<br>Assumption&nbsp;<span class="hljs-keyword">Cache</span>&nbsp;Tracker<br>&nbsp;&nbsp;ModulePass&nbsp;Manager<br>&nbsp;&nbsp;&nbsp;&nbsp;FunctionPass&nbsp;Manager<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dominator&nbsp;Tree&nbsp;Construction<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Promote&nbsp;<span class="hljs-keyword">Memory</span>&nbsp;<span class="hljs-keyword">to</span>&nbsp;<span class="hljs-keyword">Register</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">Module</span>&nbsp;Verifier<br>&nbsp;&nbsp;&nbsp;&nbsp;Bitcode&nbsp;Writer<br></code></pre>
<p><em>注：</em></p>
<ul>
<li><p>实际启用的优化在<code>Pass Arguments</code>中列出。比如：<code>targetlibinfo</code>、<code>tti</code>、<code>domtree</code>、<code>mem2reg</code>等。</p></li>
<li><p>在 FunctionPass Manager 中，优化的执行先后顺序依次为：Dominator Tree Construction、Promote Memory to Register。这表明，优化<code>mem2reg</code>依赖于<code>domtree</code>。</p></li>
</ul>
<hr>
<h3 id="hspanidjump5span"><span><span id="jump5">查看优化的执行时间</span></span></h3>
<p><strong>1）</strong> 使用 clang 驱动器时，查看优化的执行时间</p>
<p>命令格式（示例）：</p>
<pre><code class="hljs xml">$&nbsp;clang&nbsp;-Xclang&nbsp;-ftime-report&nbsp;-emit-llvm&nbsp;-O<span class="hljs-tag">&lt;<span class="hljs-name">level</span>&gt;</span>&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">source-file</span>&gt;</span>&nbsp;-c&nbsp;-o&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">bitcode-file</span>&gt;</span><br></code></pre>
<p><em>注：</em>上述命令的输出结果中除了优化的执行时间之外，还有其他的执行时间。</p>
<p>示例：</p>
<pre><code class="hljs php">$&nbsp;clang&nbsp;-Xclang&nbsp;-ftime-report&nbsp;-emit-llvm&nbsp;-O1&nbsp;test.c&nbsp;-c&nbsp;-o&nbsp;test_O1_clang.bc<br></code></pre>
<p>输出结果如下（部分）：</p>
<pre><code class="hljs vbscript">===-------------------------------------------------------------------------===<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Miscellaneous&nbsp;Ungrouped&nbsp;Timers<br>===-------------------------------------------------------------------------===<br><br>&nbsp;&nbsp;&nbsp;---User&nbsp;<span class="hljs-built_in">Time</span>---&nbsp;&nbsp;&nbsp;--User+System--&nbsp;&nbsp;&nbsp;---Wall&nbsp;<span class="hljs-built_in">Time</span>---&nbsp;&nbsp;---&nbsp;Name&nbsp;---<br>&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0687</span>&nbsp;(&nbsp;<span class="hljs-number">92.3</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0687</span>&nbsp;(&nbsp;<span class="hljs-number">92.3</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0691</span>&nbsp;(&nbsp;<span class="hljs-number">92.2</span>%)&nbsp;&nbsp;Code&nbsp;Generation&nbsp;<span class="hljs-built_in">Time</span><br>&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0058</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">7.7</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0058</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">7.7</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0059</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">7.8</span>%)&nbsp;&nbsp;LLVM&nbsp;IR&nbsp;Generation&nbsp;<span class="hljs-built_in">Time</span><br>&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0745</span>&nbsp;(<span class="hljs-number">100.0</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0745</span>&nbsp;(<span class="hljs-number">100.0</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0750</span>&nbsp;(<span class="hljs-number">100.0</span>%)&nbsp;&nbsp;Total<br><br>===-------------------------------------------------------------------------===<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;Pass&nbsp;execution&nbsp;timing&nbsp;report&nbsp;...<br>===-------------------------------------------------------------------------===<br>&nbsp;&nbsp;Total&nbsp;Execution&nbsp;<span class="hljs-built_in">Time</span>:&nbsp;<span class="hljs-number">0.0453</span>&nbsp;seconds&nbsp;(<span class="hljs-number">0.0455</span>&nbsp;wall&nbsp;clock)<br><br>&nbsp;&nbsp;&nbsp;---User&nbsp;<span class="hljs-built_in">Time</span>---&nbsp;&nbsp;&nbsp;--User+System--&nbsp;&nbsp;&nbsp;---Wall&nbsp;<span class="hljs-built_in">Time</span>---&nbsp;&nbsp;---&nbsp;Name&nbsp;---<br>&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0049</span>&nbsp;(&nbsp;<span class="hljs-number">10.9</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0049</span>&nbsp;(&nbsp;<span class="hljs-number">10.9</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0049</span>&nbsp;(&nbsp;<span class="hljs-number">10.8</span>%)&nbsp;&nbsp;Simplify&nbsp;the&nbsp;CFG<br>&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0043</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">9.6</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0043</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">9.6</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0043</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">9.5</span>%)&nbsp;&nbsp;Induction&nbsp;Variable&nbsp;Simplification<br>&nbsp;&nbsp;&nbsp;省略&nbsp;...<br>&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0003</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">0.7</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0003</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">0.7</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0003</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">0.7</span>%)&nbsp;&nbsp;Memory&nbsp;SSA<br>&nbsp;&nbsp;&nbsp;省略&nbsp;...<br>&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0000</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">0.0</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0000</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">0.0</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0000</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">0.0</span>%)&nbsp;&nbsp;Unroll&nbsp;loops<br>&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0453</span>&nbsp;(<span class="hljs-number">100.0</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0453</span>&nbsp;(<span class="hljs-number">100.0</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0455</span>&nbsp;(<span class="hljs-number">100.0</span>%)&nbsp;&nbsp;Total<br><br>===-------------------------------------------------------------------------===<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Clang&nbsp;front-<span class="hljs-keyword">end</span>&nbsp;<span class="hljs-built_in">time</span>&nbsp;report<br>===-------------------------------------------------------------------------===<br>&nbsp;&nbsp;Total&nbsp;Execution&nbsp;<span class="hljs-built_in">Time</span>:&nbsp;<span class="hljs-number">0.0844</span>&nbsp;seconds&nbsp;(<span class="hljs-number">0.0848</span>&nbsp;wall&nbsp;clock)<br><br>&nbsp;&nbsp;&nbsp;---User&nbsp;<span class="hljs-built_in">Time</span>---&nbsp;&nbsp;&nbsp;--System&nbsp;<span class="hljs-built_in">Time</span>--&nbsp;&nbsp;&nbsp;--User+System--&nbsp;&nbsp;&nbsp;---Wall&nbsp;<span class="hljs-built_in">Time</span>---&nbsp;&nbsp;---&nbsp;Name&nbsp;---<br>&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0803</span>&nbsp;(<span class="hljs-number">100.0</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0041</span>&nbsp;(<span class="hljs-number">100.0</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0844</span>&nbsp;(<span class="hljs-number">100.0</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0848</span>&nbsp;(<span class="hljs-number">100.0</span>%)&nbsp;&nbsp;Clang&nbsp;front-<span class="hljs-keyword">end</span>&nbsp;<span class="hljs-built_in">timer</span><br>&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0803</span>&nbsp;(<span class="hljs-number">100.0</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0041</span>&nbsp;(<span class="hljs-number">100.0</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0844</span>&nbsp;(<span class="hljs-number">100.0</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0848</span>&nbsp;(<span class="hljs-number">100.0</span>%)&nbsp;&nbsp;Total<br></code></pre>
<p><strong>2）</strong> 使用 opt 工具时，查看优化的执行时间</p>
<p>命令格式（示例）：</p>
<pre><code class="hljs delphi">$&nbsp;opt&nbsp;-time-passes&nbsp;-O&lt;level&gt;&nbsp;&lt;bitcode-<span class="hljs-keyword">file</span>&nbsp;<span class="hljs-keyword">or</span>&nbsp;assembly-<span class="hljs-keyword">file</span>&gt;&nbsp;-o&nbsp;&lt;bitcode-<span class="hljs-keyword">file</span>&gt;<br></code></pre>
<p>示例：</p>
<pre><code class="hljs perl">$&nbsp;opt&nbsp;-<span class="hljs-keyword">time</span>-passes&nbsp;-O1&nbsp;test_without_optnone.ll&nbsp;-o&nbsp;test_without_optnone_O1_opt.bc<br></code></pre>
<p>输出结果如下（部分）：</p>
<pre><code class="hljs lua">===<span class="hljs-comment">-------------------------------------------------------------------------===</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;Pass&nbsp;execution&nbsp;timing&nbsp;report&nbsp;...<br>===<span class="hljs-comment">-------------------------------------------------------------------------===</span><br>&nbsp;&nbsp;Total&nbsp;Execution&nbsp;Time:&nbsp;<span class="hljs-number">0.0404</span>&nbsp;seconds&nbsp;(<span class="hljs-number">0.0405</span>&nbsp;wall&nbsp;<span class="hljs-built_in">clock</span>)<br><br>&nbsp;&nbsp;&nbsp;<span class="hljs-comment">---User&nbsp;Time---&nbsp;&nbsp;&nbsp;--System&nbsp;Time--&nbsp;&nbsp;&nbsp;--User+System--&nbsp;&nbsp;&nbsp;---Wall&nbsp;Time---&nbsp;&nbsp;---&nbsp;Name&nbsp;---</span><br>&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0050</span>&nbsp;(&nbsp;<span class="hljs-number">12.4</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0001</span>&nbsp;(&nbsp;<span class="hljs-number">73.5</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0051</span>&nbsp;(&nbsp;<span class="hljs-number">12.7</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0051</span>&nbsp;(&nbsp;<span class="hljs-number">12.7</span>%)&nbsp;&nbsp;Simplify&nbsp;the&nbsp;CFG<br>&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0035</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">8.7</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0000</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">0.0</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0035</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">8.7</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0035</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">8.7</span>%)&nbsp;&nbsp;Induction&nbsp;Variable&nbsp;Simplification<br>&nbsp;&nbsp;&nbsp;省略&nbsp;...<br>&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0003</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">0.9</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0000</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">0.0</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0003</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">0.8</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0003</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">0.8</span>%)&nbsp;&nbsp;Memory&nbsp;SSA<br>&nbsp;&nbsp;&nbsp;省略&nbsp;...<br>&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0000</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">0.0</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0000</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">0.0</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0000</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">0.0</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0000</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">0.0</span>%)&nbsp;&nbsp;Unroll&nbsp;loops<br>&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0000</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">0.0</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0000</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">0.0</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0000</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">0.0</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0000</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">0.0</span>%)&nbsp;&nbsp;Scoped&nbsp;NoAlias&nbsp;Alias&nbsp;Analysis<br>&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0000</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">0.0</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0000</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">0.0</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0000</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">0.0</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0000</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">0.0</span>%)&nbsp;&nbsp;Target&nbsp;Transform&nbsp;Information<br>&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0000</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">0.0</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0000</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">0.0</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0000</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">0.0</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0000</span>&nbsp;(&nbsp;&nbsp;<span class="hljs-number">0.0</span>%)&nbsp;&nbsp;Profile&nbsp;summary&nbsp;info<br>&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0403</span>&nbsp;(<span class="hljs-number">100.0</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0002</span>&nbsp;(<span class="hljs-number">100.0</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0404</span>&nbsp;(<span class="hljs-number">100.0</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0405</span>&nbsp;(<span class="hljs-number">100.0</span>%)&nbsp;&nbsp;Total<br><br>===<span class="hljs-comment">-------------------------------------------------------------------------===</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LLVM&nbsp;IR&nbsp;Parsing<br>===<span class="hljs-comment">-------------------------------------------------------------------------===</span><br>&nbsp;&nbsp;Total&nbsp;Execution&nbsp;Time:&nbsp;<span class="hljs-number">0.0045</span>&nbsp;seconds&nbsp;(<span class="hljs-number">0.0045</span>&nbsp;wall&nbsp;<span class="hljs-built_in">clock</span>)<br><br>&nbsp;&nbsp;&nbsp;<span class="hljs-comment">---User&nbsp;Time---&nbsp;&nbsp;&nbsp;--System&nbsp;Time--&nbsp;&nbsp;&nbsp;--User+System--&nbsp;&nbsp;&nbsp;---Wall&nbsp;Time---&nbsp;&nbsp;---&nbsp;Name&nbsp;---</span><br>&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0044</span>&nbsp;(<span class="hljs-number">100.0</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0001</span>&nbsp;(<span class="hljs-number">100.0</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0045</span>&nbsp;(<span class="hljs-number">100.0</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0045</span>&nbsp;(<span class="hljs-number">100.0</span>%)&nbsp;&nbsp;Parse&nbsp;IR<br>&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0044</span>&nbsp;(<span class="hljs-number">100.0</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0001</span>&nbsp;(<span class="hljs-number">100.0</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0045</span>&nbsp;(<span class="hljs-number">100.0</span>%)&nbsp;&nbsp;&nbsp;<span class="hljs-number">0.0045</span>&nbsp;(<span class="hljs-number">100.0</span>%)&nbsp;&nbsp;Total<br></code></pre>
<hr>
<h3 id="hspanidjumpreferencesreferencesspan"><span><span id="jumpReferences">References</span></span></h3>
<ul>
<li><p><a href="http://faculty.sist.shanghaitech.edu.cn/faculty/songfu/course/spring2018/CS131/llvm.pdf"><font size="4">Getting Started with LLVM Core Libraries</font></a></p></li>
<li><p><a href="https://llvm.org/docs/NewPassManager.html#invoking-opt"><font size="4">Using the New Pass Manager</font></a></p></li>
<li><p><a href="https://llvm.org/docs/Passes.html"><font size="4">LLVM’s Analysis and Transform Passes</font></a></p></li>
</ul>
<hr>
<p><font size="4"><strong>下一篇：</strong><a href="https://csstormq.github.io/blog/LLVM%20%E4%B9%8B%20IR%20%E7%AF%87%EF%BC%884%EF%BC%89%EF%BC%9A%E5%A6%82%E4%BD%95%E5%9F%BA%E4%BA%8E%E4%BC%A0%E7%BB%9F%20Pass%20%E6%A1%86%E6%9E%B6%E6%89%A9%E5%B1%95%20LLVM%20IR%20%E4%BC%98%E5%8C%96%E5%99%A8">LLVM 之 IR 篇（4）：如何基于传统 Pass 框架扩展 LLVM IR 优化器</a></font></p>
<p><font size="4"><strong>上一篇：</strong><a href="https://csstormq.github.io/blog/LLVM%20%E4%B9%8B%20IR%20%E7%AF%87%EF%BC%882%EF%BC%89%EF%BC%9A%E5%A6%82%E4%BD%95%E7%BC%96%E5%86%99%E7%94%9F%E6%88%90%20LLVM%20IR%20%E7%9A%84%E5%B7%A5%E5%85%B7">LLVM 之 IR 篇（2）：如何编写生成 LLVM IR 的工具</a></font></p>
<p><font size="4"></font></p><p align="center"><font size="4"><a href="https://csstormq.github.io"><strong>首页</strong></a> </font></p><p></p></div></div></body>
</html>
